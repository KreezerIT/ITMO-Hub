## A. Борьба за сахар

- Лимит времени: **1000 мс**
- Лимит памяти: **128 мб**

Сидит жадина с килограммом конфет, шуршит фантиками, и никого рядом нет. Скучно ей одной, неинтересно совсем, поэтому она решила начать играть с конфетами.

Она нарисовала себе поле `N × M` клеток, зачеркнула `Q` из них и начала раскладывать прямоугольные конфеты размера `2 × 1` по клеточкам таким образом, чтобы зачёркнутые клетки остались непокрытыми, а конфеты не лежали друг на друге.

Жадина предложила вам поиграть с ней, разложить конфеты по полю, соблюдая все правила. После этого она готова будет отдать вам все разложенные конфеты. Постарайтесь выиграть как можно больше сладостей.

### Входные данные

В первой строке даны два целых числа `N`, `M` (`1 ≤ N, M ≤ 100`).  
Во второй строке целое число `Q`.  
В следующих `Q` строках записаны координаты зачеркнутой клетки `x`,`y` (`1 ≤ x ≤ N`, `1 ≤ y ≤ M`).

### Выходные данные

Выведите максимальное количество клеток, которое вы сможете покрыть конфетами.


### Примеры

---

**STDIN**
```c++
1 14
5
1 6
1 11
1 8
1 3
1 6
```

**STDOUT**
```c++
8
```

### [Решение](A.cpp)

---

## B. Шёпот далёких звёзд

- Лимит времени: **1000 мс**
- Лимит памяти: **128 мб**

Черная Дыра взяла под контроль систему  
И поглощает плач согласно поточной лемме,  
Создавая липкий ужас, который вскоре  
Каждый человек испытает собственной шкурой.

Произошла метаморфоза: звезды - теперь вершины,  
Направляющие ужас и слезы между чужими.  
Тут вершины горят.  
А между ними липкий ужас, да такой, что предпочтительнее ад.

И тут точно не может быть мало места  
Тьма нескончаемая, но чую то, что мне тесно.  
Что-то не так, кроме задач:  
Ты ощущаешь трепет, заставляет он считать тебя всемирный плач.

Звезды соединены потоками вот такими:  
Направляют они слезы до Черной Дыры с Земли.  
И вас тянет считать  
Сколько же всего может Дыра та получать?

Отвечайте зеркалу на запросы  
Воспринимайте потоки только всерьез и  
Осознавайте, что не вернете слёз,  
Падающих по вам, под шёпот далёких звёзд.

### Входные данные

В первой строке записаны два натуральных числа `N` и `M` - количество звезд и количество связей между ними. (`1 ≤ N, M ≤ 10⁴`).  

Далее в `M` строках передаются 3 числа: Исходный небесный объект (`1 ≤ u ≤ N`), конечный небесный объект (`1 ≤ v ≤ N`), и пропускная способность звездных потоков (`0 < c ≤ 10²`).

`1` всегда Земля, `N` - всегда Черная Дыра.

### Выходные данные

Натуральное число `K` - максимальное количество слез, которое может получить Черная Дыра.


### Примеры

---

**STDIN**
```c++
10 21
1 2 46
1 5 72
2 3 73
2 7 30
3 4 82
4 5 28
5 6 82
5 8 77
6 7 62
7 8 16
7 10 51
8 5 93
8 9 70
8 10 62
9 2 61
9 7 37
9 10 36
10 2 17
10 3 45
10 8 85
10 10 55
```

**STDOUT**
```c++
118
```

### [Решение](B.cpp)

---

## C. А можно я с тобой?

- Лимит времени: **1000 мс**
- Лимит памяти: **128 мб**

Рыжий котёнок Кузя прогуливался по Санкт-Петербургу. Малыш любовался его архитектурой, реками, каналами, разводными мостами, в общем жил свою лучшую кошачью жизнь. Ничего не предвещало беды, как вдруг он понял, что потерялся. Вокруг были только какие-то странные и незнакомые дома. Кузя добрёл до трамвайных путей и засмотрелся на здание напротив. Его внимание привлекла башня, а именно свет из её окон. "Наверное, там очень тепло и уютно", - подумал Кузя. Он сразу решил, что сделает всё возможное и невозможное, дабы попасть туда. Кузя оббежал здание со всех сторон, и вдруг прям у входа встретил большую чёрную кошку, она представилась ему как Люси. Она выглядела очень опрятно на фоне маленького рыжего бродяги.

Люси рассказала, что просто так в эту башню котят не пускают, нужно обязательно сдать кошачий экзамен по алгоритмам. Начать она ему посоветовала с поиска максимального паросочетания в схеме того самого здания. Искать нужно в такой комбинации его коридоров, которая позволит обойти все аудитории, и при этом по суммарной протяжённости всех коридоров будет минимальной из возможных. Люси не смогла предоставить схему, ведь у неё лапки, но сказала, что в здании  
`M` коридоров и `N` аудиторий, а также назвала целых `M` наборов из трёх чисел: `A`, `B` и `C`, которые означают, что в здании существует коридор между аудиториями `A` и `B` длины `C`. Максимальным считается такое паросочетание, в котором суммарная длина всех коридоров максимальна.

Люси начала уходить, а Кузя кричал ей вслед: "Постой, можно я с тобой?". Грациозная кошка сказала, что если малыш сумеет найти максимальное паросочетание, то она заберёт его, и они вместе будут жить в той самой башне. А пока ему придётся жить одному на улицах, которые он совсем не знает. Трудные времена рождают сильных котят, помогите Кузе исполнить мечту, найдите максимальное паросочетание в схеме коридоров.

### Входные данные

Первая строка входных данных содержит два числа: `N` и `M` — количество аудиторий и коридоров соответственно (`3 ≤ N ≤ 10⁵`, `2 ≤ M ≤ 10⁶`).

В следующих `M` строках содержится описание коридоров: `Aᵢ`, `Bᵢ` и `Cᵢ`, где `Aᵢ` и `Bᵢ` — связанные этим коридором аудитории, а `Cᵢ` — его длина.

### Выходные данные

Необходимо вывести одно число: суммарную протяженность всех коридоров в максимальном паросочетании.


### Примеры

---

**STDIN**
```c++
4 4
1 2 1
2 3 2
3 4 5
4 1 4
```

**STDOUT**
```c++
6
```

---

### Примечание

- По коридору можно перемещаться в любом направлении.
- Из любой аудитории можно добраться в любую другую.
- Не существует коридора, ведущего из аудитории `A` в неё же.
- Не существует двух различных коридоров, соединяющих одинаковые аудитории.

### [Решение](C.cpp)

---

## D. Я не продаюсь, но...

- Лимит времени: **1000 мс**
- Лимит памяти: **128 мб**

Даша никак не могла найти себе подходящего котёнка, поэтому решила пойти на специальное шоу по подбору питомцев "За корм и игрушки да". В шоу принимают участие `N` котят и `N` потенциальный хозяев (все пронумерованы от `0` до `N−1`). Каждый котёнок предполагает, сколько денег есть у каждого потенциального хозяина на корм и игрушки, и записывает лапками себе в блокнот номера хозяев, в порядке убывания предполагаемого количества средств на содержание питомца. Далее каждый хозяин оценивает своё желание забрать конкретного котёнка, после чего записывает номера котят в порядке убывания своего желания.

Все участники шоу пришли туда с серьёзными намерениями, поэтому нестабильные пары питомцев и хозяев им не нужны. Если существуют пары (`wᵢ`, `mⱼ`) и (`wₖ`, `mₗ`) и котёнок `wᵢ` считает, что у `mₗ` денег на содержание больше, чем у `mⱼ`, а `mₗ` хочет подарить игрушки и корм котёнку с номером `wᵢ` больше, чем котёнку с номером `wₖ`, то эти пары считаются нестабильными.

Вы являетесь организатором этого шоу и перед вами стоит задача: распределить всех участников и котят в стабильные пары. При распределении предпочтения котят являются приоритетнее предпочтений потенциальных хозяев.

### Входные данные

В первой строке дано целое число `N` (`1 ≤ N ≤ 1500`).

В следующих `N` строках описаны предпочтения котят. В `i`-той строке предпочтения `i`-того котёнка: `N` чисел подряд — уникальные номера хозяев в порядке убывания предполагаемого этим котёнком количества денег на содержание питомца.

В следующих `N` строках аналогично описаны предпочтения хозяев.

### Выходные данные

Выведите все пары, получившиеся в результате этого шоу в формате (`w m`), где `w` — номер котёнка, `m` — номер хозяина. Пары необходимо отсортировать по номеру котёнка.

### Примеры

---

**STDIN**
```c++
2
0 1
0 1
1 0
1 0
```

**STDOUT**
```c++
0 1
1 0
```

### [Решение](D.cpp)

---

## E. La Seine

- Лимит времени: **1000 мс**
- Лимит памяти: **128 мб**

Однажды два музыканта отправились в Париж, чтобы провести концерт. Они решили, что для привлечения внимания к их дуэту стоит разработать особый маршрут, по которому будет ездить фургон с их музыкой.

Было принято решение передвигаться таким образом, чтобы их музыку было слышно на каждом мосту города. По обе стороны от каждого моста расположены перекрёстки, на которых музыканты планируют делать остановки. Они уверены, что благодаря этой тактике слух о них будет распространяться по всем мостам, связанным с текущим перекрёстком. Также они решили, что между перекрёстками им следует передвигаться лишь по мостам, переезжая с одного берега на другой.

Музыканты изучили карту города и обнаружили, что на каждом берегу реки Сена имеется своя собственная нумерация перекрёстков: на левом берегу они нумеруются от `1` до `N`, а на правом — от `1` до `K`. Оказалось, что по законам Парижа за несогласованную рекламу на перекрёстках придётся заплатить. У героев и так немного денег, помогите бедным музыкантам найти минимальный набор перекрёстков, останавливаясь лишь на которых, их музыку услышат на каждом мосту города.

### Входные данные

В первой строке записаны три целых числа: `N`, `K` и `M`, где `M` — количество мостов (`0 ≤ N, K ≤ 2⋅10³`; `M ≤ N⋅K`).

В следующих `M` строках находятся два числа: `Lᵢ` и `Rᵢ` — номера перекрёстков по левую и правую сторону реки соответственно, которые соединяет `i`-ый мост  
(`1 ≤ Lᵢ, Rᵢ ≤ 2⋅10³`).

### Выходные данные

В первой строке необходимо вывести количество выбранных перекрёстков на **левом** берегу. Во второй — их номера.

В третьей строке следует вывести количество выбранных перекрёстков на **правом** берегу. В четвёртой — их номера.


### Примеры

---

**STDIN**
```c++
2 1 2
1 1
2 1
```

**STDOUT**
```c++
0

1
1 
```

### [Решение](E.cpp)

---

## F. Летняя тоска Светланы

- Лимит времени: **1000 мс**
- Лимит памяти: **128 мб**

В преддверии выпуска нового альбома, известная певица Светлана де Роуз готовится к запуску продаж эксклюзивных виниловых пластинок. Для оптимальной транспортировки продукции ей необходимо найти наиболее эффективный маршрут в транспортной сети своей страны, в которой, к слову, `M` дорог и `N` городов.

Производство винила расположено в городе `s`. Довести весь товар необходимо до города `t`. Для каждой дороги определены её пропускная способность, равная `c`, и стоимость перевозки товара по ней, равная `p`.

Важно не только найти максимальный поток, но и минимизировать затраты на всю перевозку. У Светланы небольшой опыт в логистике, поэтому она обратилась к Вам — лучшему программисту страны, чтобы именно Вы помогли ей найти наибольший поток из города `s` в город `t` с наименьшей стоимостью.

### Входные данные

В первой строке содержатся четыре числа: `N` (`N ≤ 2000`), `M` (`M ≤ N(N−1)/2`), `s` и `t` — количество городов, дорог, номера городов `s` и `t` соответственно.

В каждой из следующих `M` строк находится описание дорог: `uᵢ`, `vᵢ`, `cᵢ` и `pᵢ`, где `uᵢ` и `vᵢ` — связанные этой дорогой города, `cᵢ` — пропускная способность дороги, а `pᵢ` — стоимость перевоза винила по ней (`uᵢ, vᵢ ≤ N`; `cᵢ, pᵢ ≤ 1000`).

### Выходные данные

Через пробел выведите два числа: максимальный поток и его минимальную стоимость.


### Примеры

---

**STDIN**
```c++
4 4 1 4
1 2 1 1
2 3 2 1
3 4 1 1
2 4 1 1
```

**STDOUT**
```c++
1 2
```

---

### Примечание

По дорогам можно передвигаться в одном направлении.

### [Решение](F.cpp)

---

## G. Highway of a lifetime

- Лимит времени: **1000 мс**
- Лимит памяти: **128 мб**

По горной дороге ехал мотоциклист Ангус. По мере того, как мотоциклист прибавлял газ, разные мысли начинали появляться в его голове, но все воспоминания были спутаны.

Ангус решил, что он хочет упорядочить их таким образом, чтобы они выстроились в единый цикл, цикл всей его жизни. Каждое воспоминание в этом цикле должно встретиться лишь единожды. Помогите мотоциклисту упорядочить воспоминания и выведите их.

### Входные данные

Первая строка входных данных содержит два числа:
- `N` - количество воспоминаний (`3 ≤ N ≤ 10⁵`);
- `M` - связи между ними (`2 ≤ M ≤ 10⁶`).

В следующих `M` строках содержится описание воспоминаний: `Aᵢ`, `Bᵢ`, где `Aᵢ` и `Bᵢ` — связанные воспоминания.  
(`0 ≤ Aᵢ,Bᵢ ≤ N−1`)

### Выходные данные

Необходимо вывести цикл из воспоминаний.


### Примеры

---

**STDIN**
```c++
4 6
0 1
1 2 
2 3
3 0
0 2
3 1
```

**STDOUT**
```c++
0 1 2 3
```

---

### Примечание

Задача не является NP-полной так как соблюдены теоремы Оре и Дирака. Нумерация начинается с нуля. Записывать вершины в очередь требуется в порядке их считывания.

### [Решение](G.cpp)

---

## H. Близкие звёзды

- Лимит времени: **5000 мс**
- Лимит памяти: **256 мб**

Мне приснилось небо Лондона.  
В нём приснился целый млечный путь.  
Млечный путь далеко не прост,  
Он - взвешенное дерево из `N` звёзд.

Мы летели разные пути  
От звезды по млеку до звезды.  
Длина пути – не шажочки,  
А сколько `M` млеков до последней точки.

Побежали летать. Не лучше остаться,  
Надо взлететь, улететь, налетаться.  
От звезды до смежной по млечности  
Займёт `t` мгновений из вечности.  
Время в пути суммарное `T`.

Кто же из нас первый долетит?…  
Близкие звёзды - те, не иначе,  
Где `M` и `T` меньше вводных в задаче.

Я же дарю тебе звезду, ты послушай,  
Ты молчишь, напряги ж свои уши.  
Не оставляй до выходных,  
Детали все в прозе в данных входных.

Кто показал тебе звезды утром?  
Кто научил тебя видеть ночью?  
Я, я всегда буду за тебя, я не таю,  
Сколько пар близких звёзд найдешь ты, летая?

Кто, если не я...

**Речитатив в конце для тех, кто не понял**:

Млечный Путь - взвешенное дерево из `N` звёзд (звёзды пронумерованы от `1` до `N`).  
Млеки - рёбра дерева (имеют неотрицательное время прохождения `t`).  
Длина пути `M` между двумя звёздами - количество млеков в пути.  
Время в пути `T` - сумма времени прохождения `t` всех млеков на пути.  
Близкие звёзды - те, между которыми существует путь длины `≤ L` и временем его прохождения `≤ W`.

### Входные данные

В первой строке даны три целых числа `N`, `L` и `W`  
(`1 ≤ N ≤ 10⁵`, `1 ≤ L ≤ N`, `0 ≤ W ≤ 10⁹`).

В следующих `N−1` строках дано описание млеков. В `i`-той строке записано два целых числа `pᵢ`, `tᵢ`  
(`1 ≤ pᵢ < (i+1)`, `0 ≤ tᵢ ≤ 10⁴`), которые обозначают, что `i`-тое млеко соединяет звёзды `(i+1)` и `pᵢ` и имеет время прохождения `tᵢ`.

### Выходные данные

Выведите количество пар близких звёзд.

### Примеры

---

**STDIN**
```c++
4 4 6
1 3
1 4
1 3
```

**STDOUT**
```c++
4
```

---

**STDIN**
```c++
6 2 17
1 3
2 5
2 13
1 6
5 9
```

**STDOUT**
```c++
9
```

---

### Примечание

Для решения задачи можно использовать центроидную декомпозицию.

---
