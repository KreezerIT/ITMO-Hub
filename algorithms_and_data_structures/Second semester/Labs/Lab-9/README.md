## A. Конец или Начало

- Лимит времени: **1000 мс**
- Лимит памяти: **128 мб**

"Я не могу молчать! Всё вокруг кажется нереальным, но в то же время каким-то слишком настоящим. Кажется, я теряю себя. Я помню, как они пришли ко мне. Они спрашивали про сейф, какой-то сейф с деньгами или секретами, они говорили очень странно. Они хотят украсть у меня что-то, определённо. Говорили, что хотят помочь мне, но я им не верю. Ощущение того, что всё это сон, не покидает меня. Я хочу знать, так ли это, хочу понять, кому нужен этот сейф, секрет, тайна, да что бы там ни было, на самом деле. Сам я не смогу остановить 'их', мне нужна помощь. Я не знаю, к кому мне обратиться, никто же не поверит мне. А если это на самом деле сон, а они им каким-то образом управляют, они же не дадут мне узнать этого! Не позволят! Всё, что я могу сейчас сделать, это оставить свои записи. Может Вы, заинтересованный читатель, именно Вы, читая сейчас эти строки, поймёте, как помочь мне. Даже если со мной уже что-то случилось, может Вы обезопасите других. Вероятно, они могут навредить и другим. Мне нужно всё обдумать. Если это странное ощущение не пройдёт, я продолжу писать, лишь бы кто-то нашел мои записи, лишь бы это было не зря."

"Я не знаю, сколько времени прошло. Кажется, что я только-только отложил свой блокнот, но чернила от ручки выцвели так, словно кто-то оставил его раскрытым под палящим солнцем на месяц, не меньше! Такого же не происходит в жизни! Или я схожу с ума? Мне не стоит оставлять свои записи где попало, если их увидит кто-то 'лишний', они всё поймут. Они поймут, что я всё знаю."

"Всё становится более странным и пугающим. Я проснулся. Всё, что было раньше, действительно было сном! Но хорошие новости на этом заканчиваются. Я проснулся в новом сне. Ощущение всё то же, поменялось только окружение, моя одежда, но это не по-настоящему. Я не помню, как вышел из предыдущего сна, поэтому не понимаю, как провернуть этот трюк вновь. Кажется, стоит как-то структурировать свои записи, чтобы по ним Вы смогли помочь мне разобраться со всем."

"Хочу договориться с Вами, дорогой читатель, каждый новый сон я буду обозначать числом `A`. Если есть такой сон, в который я проснулся из сна `A`, давайте мы назовём его `B`, то сны `A` и `B` будут крепко связаны между собой. Но пусть это работает в обе стороны, пусть как `A` связано с `B`, так и `B` связано с `A`. Если в записях вдруг будет какая-то цепочка из сна `C` в сон `D`, то назовём такие сны просто связанными, не крепко. В случае моего примера со снами `A` и `B` они тоже просто связаны, крепкую связь будем считать частным случаем обычной связи. Что с этим делать, я пока не придумал. Напишу здесь позже."

"Ситуация не лучше. Ни капельки. Я начинаю путаться во снах. Кажется, что тот сон, из которого я проснулся в этот, был связан с каким-то другим. Точно не с этим. Кажется, я знаю, какая помощь мне нужна от Вас. Я хочу структурировать все эти связи, распутать эту непонятную паутину. Я хочу, чтобы Вы отвечали на запросы:

- `? A B` — тогда Вам нужно ответить, связаны ли сны `A` и `B`.
- `- A B` — тогда считайте, что крепко связанные сны `A` и `B` больше не связаны.

Надеюсь, Ваши исследования кому-то помогут. Даже если не мне."

### Входные данные

Первая строка входного файла содержит три целых числа, разделённые пробелами:  
`n` (`1 ≤ n ≤ 100000`) — количество снов,  
`m` (`0 ≤ m ≤ 100000`) — количество связей между ними,  
`q` (`0 ≤ q ≤ 100000`) — количество запросов Рассказчика.  
`(n + m) ⋅ q ≤ 10⁷`.

Следующие `m` строк задают связи между снами:
`Aᵢ Bᵢ` — сны, связанные `i`-ой связью.

Далее следуют `q` строк, описывающих запросы Рассказчика. В начале строки находится символ `tᵢ` (`?` или `-`) — тип запроса, за которым следуют два числа `A B` (`1 ≤ A, B ≤ n`).

- Если `tᵢ = ?`, то необходимо вывести `YES`, если сны `A` и `B` связаны, иначе — `NO`.
- Если `tᵢ = -`, то следует считать, что крепко связанные сны `A` и `B` больше не связаны.

### Выходные данные

Для каждой операции `? A B` во входном файле выведите на отдельной строке `YES`, если сны `A` и `B` связаны, иначе выведите `NO`.

### Примеры

---

**STDIN**
```c++
3 3 8
1 2
2 3
1 3
? 1 1
? 1 3 
- 1 2
? 1 3
- 2 3
? 2 3
- 1 3
? 1 1
```

**STDOUT**
```c++
YES
YES
YES
NO
YES
```

### [Решение](A.cpp)

---

## B. 3001: Галактическая Илиада

- Лимит времени: **1000 мс**
- Лимит памяти: **256 мб**

Сергей Кубик — невероятно талантливый и изобретательный режиссёр, продюсер и сценарист, но у каждого творческого человека рано или поздно наступает момент, когда Муза его покидает, и наш герой не стал исключением.

И вот выдалась очередная бессонная ночь, Сергей стоит у окна и наблюдает за звёздами. Такими близкими, такими далёкими, такими родными и чужими одновременно. Невероятно, что наши предки смотрели на эти же звёзды. Они сравнивали их с драконами, пытались предсказывать по ним будущее. Эти мысли будоражили Сергея, и тут, словно вернувшись из длительного путешествия по соседним галактикам, к нему пришло то самое долгожданное вдохновение. Звезды и галактики — то, чего ему так не хватало всё это время!

Художественные фильмы про мечтателей совсем не вписываются в его репертуар, нужно снимать документальный фильм про науку. Так и появился проект ITMO 1900. Учёные изучали образования новых галактик. В ходе исследований они обнаружили `n` галактик, в каждой из которых была только одна звезда. В начале было непонятно, что будет с ними происходить, поэтому исследователи решили записывать больше данных о звёздах, а именно их яркость. Хранили они эти данные таким образом, что если пронумеровать все звёзды от `1` до `n`, то для `i`-ой звезды мера её яркости равна `i`.

Шло время, и вдруг учёные заметили, что те самые `n` галактик стали сталкиваться между собой, образуя новые, содержащие в себе все звёзды своих "родителей", да происходило всё это с такой скоростью, что даже яркость звёзд никак не изменялась со временем. Например, если в первой галактике находились звезды с яркостью `[1, 2, 4]`, во второй — `[3, 6]`, а в третьей — `[7, 9]`, то после столкновения первой галактики со второй их останется две: в первой будут звезды `[1, 2, 3, 4, 6]`, а во второй — `[7, 9]`. После этого исследовали ввели меру яркости галактики, равной медианной яркости звезды в галактике. Для галактики `[1, 2, 3, 4, 6]` эта мера равна `3`, а для `[7, 9]` — `7`.

Бешеная скорость образования новых галактик сильно мешала учёным: они не успевали проводить все необходимые замеры. Тут Сергей Кубик начал переживать, ведь без настоящего прорыва в исследованиях никто не станет смотреть его картину. Нельзя было упускать такой шанс, мир должен узнать о проекте ITMO 1900, и не просто от кого-то, а от Кубика! К режиссёру пришло озарение, необходимо пригласить в команду самых умных программистов, которые смогут смоделировать поведение галактик. Посоветовавшись с учёными, Сергей сформировал техническое задание для кандидатов. Вам необходимо быстро обрабатывать два типа запросов:

- `1 x y` — галактика, содержащая звезду яркости `x`, и галактика, содержащая звезду яркости `y`, сталкиваются.
- `2 x` — необходимо вывести яркость галактики, содержащей звезду с яркостью `x`.

Не упустите свой шанс попасть в кинофильм самого Сергея Кубика!

### Входные данные

В первой строке входных данных расположены два целых числа `n` и `q` (`1 ≤ n, q ≤ 2⋅10⁵`) — количество звезд и количество запросов соответственно.

В каждой из следующих `q` строк находится по одному запросу. В начале строки находится число `tᵢ` (`1 ≤ tᵢ ≤ 2`) — тип запроса. Далее сам запрос:

- если `tᵢ = 1`, то далее следуют два целых числа `x` и `y` (`1 ≤ x, y ≤ n`) — яркости звезд, которые находятся в столкнувшихся галактиках;
- если `tᵢ = 2`, то далее следует целое число `x` (`1 ≤ x ≤ n`), которое обозначает, что необходимо вывести яркость галактики, содержащей звезду с яркостью `x`.

### Выходные данные

Для каждого запроса типа `2 x` выведите в отдельной строке число — яркость галактики, содержащей звезду с яркостью `x`.

### Примеры

---

**STDIN**
```c++
9 13
1 2 8
1 3 5
2 8
2 4
1 8 3
2 2
1 1 6
1 1 9
2 1
1 1 2
2 8
2 9
2 7
```

**STDOUT**
```c++
2
4
3
6
5
5
7
```

---

### Примечание

Если в запросе `1 x y` звёзды с яркостью `x` и `y` уже находятся в одной галактике, то ничего не происходит.

---

## C. Если я вас больше не увижу

- Лимит времени: **1000 мс**
- Лимит памяти: **128 мб**

> Нам наскучило смотреть на актёров с их фальшивыми эмоциями. Мы устали от взрывов и спецэффектов. И хотя мир, в котором он живёт… в некотором смысле, подделка, в самом Трумане нет ничего фальшивого — никаких сценариев, и заготовок. Это не во всём Шекспир, но это всегда искренне. Это — жизнь.

Счастье — быть страховым агентом в любимом городке Сихэвен!

Но у главного героя — Трумана — появились какие-то подозрения. А давайте посмотрим прямо в его голову. Там находится `n` нейронных связей и `m` синаптических путей. Каждый путь — принятие Труманом решения и преодоление психологических барьеров, с которыми он столкнулся, пытаясь отличить реальность от иллюзии. Чтобы пройти синаптический путь, потребуется какое-то время.

Труман начинает своё психологическое путешествие от **первой мысли** (первая нейронная связь) до **полного осознания** (последняя нейронная связь), стремясь минимизировать время, затраченное на преодоление пути через эту сложную сеть решений.

### Входные данные

Первая строка содержит два числа:  
`n` — количество нейронных связей (`1 ≤ n ≤ 10⁵`),  
`m` — количество синаптических путей между ними (`1 ≤ m ≤ 3 ⋅ 10⁵`).

Следующие `m` строк описывают синаптические пути. Каждая строка содержит информацию о двух связях `a` и `b`, соединённых синаптическим путём, и время прохождения `t` (`1 ≤ t ≤ 10⁶`)

### Выходные данные

Одно число — минимальное время, которое требуется Труману, чтобы пройти от начала его психологического путешествия до полного осознания.
Если осознание невозможно, выведите: `-1`.

### Примеры

---

**STDIN**
```c++
5 6
1 2 2
2 3 3
3 4 2
4 5 1
1 3 5
2 5 10
```

**STDOUT**
```c++
8
```

### [Решение](C.cpp)

---

## D. You can, Ken!

- Лимит времени: **1000 мс**
- Лимит памяти: **128 мб**

Из реального мира, гласят кинохроники,  
Барби бежала сначала на роликах,  
Потом снегоход, фургон и ракета,  
Велик, катер, машина и это,  
Чтоб в Барбилэнд свой милый вернуться  
И утром почти идеальной проснуться.

И рассказать подробно, детально:  
«Ужас, кошмар и так, мол, и так,  
Не представляете, миром реальным  
Правят мужчины на лошадях!  
Так справедливость может пропасть,  
Ведь всё существует, как будто специально,  
Чтобы удерживать эту власть.  
А это не так уж и идеально».

Созвали съезд, провели конференцию.  
Нет, не хотим «День Весны и Цветов».  
Мы — разные Барби, из разных коллекций  
Цвета волос, комплекций и наций,  
Чтобы идеи внедрились в судьбе,  
Провозглашаем хит из хитов:  
«День солидарности женщин в борьбе  
За Равноправие с Эмансипацией».

Решение в Барбилэнд по старинке  
Предполагало и вечеринку.  
Где же её теперь провести??  
Так, ситуацию нужно спасти!  
Домик Барби найти подходящий,  
Чтобы праздник прошёл настоящий.

Кто разрешить задачу готов:  
В городе в целом есть  
`N` домов и `M` тропинок лежит между ними  
(Барби там ходят ногами прямыми).  
Нужно найти тот дом идеальный,  
Чтобы рассчитан он был с минимальной  
Суммой дорог до него (расстояний)  
От всех существующих Барби-зданий.

Все напряглись, но один серфингист  
Вызвался миру помочь! Супермен?  
Нет, просто он еще программист,  
И Барби сказала ему: ”You can, Ken!”

### Входные данные

В первой строке даны два целых числа  
`N` — количество Барби-домиков и  
`M` — количество дорог между ними  
(`1 ≤ N ≤ 500`; `0 ≤ M ≤ 500`).

Далее следует `M` строк с описанием дорог:  
(`x`, `y`, `l`) — дорога длины `l` (`0 ≤ l ≤ 2⁶⁴`), соединяющая домики  
`x` и `y` (`1 ≤ x, y ≤ N`).

### Выходные данные

Выведите номер домика, в котором Барби следует провести вечеринку.

### Примеры

---

**STDIN**
```c++
5 4
1 2 2
1 3 4
3 4 2
1 5 1
```

**STDOUT**
```c++
1
```

---

### Примечание

Гарантируется, что из любого домика можно добраться в любой другой.

Между двумя Барби-домиками может быть более одной дороги.  

Могут существовать дороги, ведущие из домика `i` в него же.

### [Решение](D.cpp)

---

## E. Ничто нигде и никогда

- Лимит времени: **1000 мс**
- Лимит памяти: **128 мб**

Ты ведь тоже это ощущаешь? Будто всё не так... Одежда сидит совсем иначе на другой день и волосы не ложатся так, как тебе нравится. Даже кофе на вкус не тот. Наши основы разрушаются, мы уже не доверяем своим близким. А по ночам мы задаёмся одним вопросом: как всё вернуть?..

Но вернуть уже не получится. В нашем мире пустило корни великое зло и оно продолжает сеять хаос в других вселенных. Оказалось, что оно поглощает не только свет и материю. Оно может уничтожать целые миры и переходы между ними. Конец неизбежен... Ничто не имеет смысла...

Будет всего несколько коротких мгновений, когда хоть что-то важно. И вы хотите продлить это время. Для этого вам и вашим сокомандникам из альфа-мира необходимо поддерживать связь между оставшимися `N` вселенными. Многих из вас уже поглотила вечная пустота, поэтому контролировать все `M` переходов между мирами вы не сможете. Необходимо сконцентрироваться на тех переходах, потери которых нанесут больший ущерб, то есть при уничтожении которых пропадёт единственный возможный путь между двумя мирами.

### Входные данные

В первой строке даны два целых числа  
`N` — количество миров и  
`M` — количество переходов между ними  
(`1 ≤ N ≤ 10⁴`; `0 ≤ M ≤ 10⁵`)

Далее следует `M` строк, содержащих пары миров  
(`x, y`) — между которыми есть переход  
(`1 ≤ x, y ≤ N`)

### Выходные данные

Выведите все пары миров (`x, y`) — переход между которыми будет охранять ваша команда (`xᵢ ≤ yᵢ`, `xᵢ ≤ xᵢ₊₁`)
### Примеры

---

**STDIN**
```c++
6 7
1 2
2 3
3 4
1 3
4 5
4 6
5 6
```

**STDOUT**
```c++
3 4
```

---

**STDIN**
```c++
9 9
3 8
9 1
4 7
2 8
6 3
8 9
2 5
8 5
1 8
```

**STDOUT**
```c++
3 6
3 8
4 7
```

### [Решение](E.cpp)

---

## F. Сокровенные желания

- Лимит времени: **1000 мс**
- Лимит памяти: **128 мб**

Зона - это очень сложная система. Это огромный лабиринт внутри которого умрут все желания, и звучит лишь эхо тех, кто пытался проникнуть в его тайны. Здесь пути переплетаются и ведут в никуда, создавая вихрь событий и забывчивость даже у меня, а вы можете даже не надеяться.

Мы не то чтобы рискуем, отправившись вглубь Зоны, мы отдаём свою жизнь. Мы сталкиваемся с этими пространствами, где каждое место соединено с другим неким путем, и, кажется, что за каждым поворотом скрывается ответ, но на самом деле, здесь повсюду воронки, в которых время и пространство теряют свой смысл. Воронки — это не одно место, а целая череда путей такая, что суммарная нормальность всех путей в воронке - отрицательна.

Вы вот говорите, что знаете физику? Эксперименты, факты, истина в последней инстанции. Да фактов вообще не бывает, а здесь и подавно. Здесь все кем-то выдумано. Все это чья-то идиотская выдумка. Неужели вы не чувствуете? А вам, конечно, до зарезу нужно знать, чья. Да почему? Что толку от ваших знаний? Чья совесть от них заболит? Моя?

Обругает какая-нибудь сволочь — рана. Другая сволочь похвалит — ещё рана. Душу вложишь, сердце своё вложишь — сожрут и душу, и сердце. Мерзость вынешь из души — жрут мерзость. Они же все поголовно грамотные, у них у всех сенсорное голодание. И все они клубятся вокруг — журналисты, редакторы, критики, бабы какие-то непрерывные. И все требуют: «Давай! Давай!..»

Нам пройти надо, а там воронки, представь себе идёшь ты вперёд, а возвращаешься обратно. Ещё одну карту не нарисуешь, придётся рисовать `N` штук. Ну как рисовать, я только пути знаю, никто всю Зону знать не может. Это нам с вами ещё повезло, а вот стервятнику не повезло...

Слушайте внимательно. Не все воронки обойти получится, вот все которые меньше `k` длиной - пройти сможем, иначе кранты. Я вам карты дам, вы записывайте главное, я буду называть сначала сколько точек на карте нарисовать, ну `n` допустим, потом сколько путей `m` рисовать будете, а потом сами пути называть, что-то вроде `u v h`, где `u` и `v` - номера точек на карте, которым можем пройти, а `h` - их нормальность. Я как говорю путь, так вы и идите, в другую сторону нельзя, если не скажу. Вот как нарисуете все `N` карт - внимательно посмотрите и скажите `YES`, если пройти сможем и `NO`, если не сможем.

И запомните, не на каждый ответ найдется вопрос, но место, куда мы идём... Пусть исполнится то, что задумано. Пусть они поверят. И пусть посмеются над своими страстями; ведь то, что они называют страстью, на самом деле не душевная энергия, а лишь трение между душой и внешним миром. А главное, пусть поверят в себя и станут беспомощными, как дети, потому что слабость велика, а сила ничтожна.

### Входные данные

В первой строке два числа `1 ≤ N ≤ 1000`, `0 ≤ k ≤ N`.

Далее идёт `N` блоков:

На первой строке блока два числа `1 ≤ n ≤ 10⁵`, `0 ≤ m ≤ 10⁵`.

Следующие `m` строк содержат по три числа: `1 ≤ u ≤ n`, `1 ≤ v ≤ n`, `-10⁶ ≤ h ≤ 10⁶`.

### Выходные данные

Выведите `NO` или `YES`.

### Примеры

---

**STDIN**
```c++
2 0
6 6
5 6 5145
5 3 5463
3 4 4280
6 2 492
3 1 4828
5 1 -99931
10 9
3 1 12383
3 8 5115
8 4 7123
8 10 1870
8 6 11696
3 9 14100
10 2 1126
3 7 538
8 5 6869
```

**STDOUT**
```c++
YES
YES
```

---

### Примечание

На каждой карте не более одной воронки.

---

## G. Бегущий по графу 2к39

- Лимит времени: **2000 мс**
- Лимит памяти: **512 мб**

Будущее. Мир, где искусственный интеллект стал неотъемлемой частью повседневной жизни. Города поглотили мрачные небоскребы, а люди слились с машинами, став частью цифрового мира.

История открывается с пролета над серым, умирающим Санкт-Петербургом будущего и его пустынными окрестностями.

Главный герой Лазарь (для удобства будем называть его Л) пролетает на своем спиннере (летающей машине) в безжизненную глушь, где находит фермера, который выращивает анчоусы в парниках. Этот морепродукт стал основным рационом питания людей будущего, чистый белок, который не позволяет людям умереть от голода.

Фермером оказывается великан АХО, но Л быстро его раскрывает — перед ним беглый репликант, который много лет назад дезертировал во время военных действий на отдаленной инопланетной колонии.

Перед тем как герой дезинтегрирует фермера, тот равняет фразу: «Ты не видел чуда», — эта фраза еще сыграет свою роль в истории.

Перед домом Л находит мертвое дерево, а под ним — останки неизвестной женщины. Уже в полицейском участке СПБ выясняется, что женщина умерла при родах, но самое странное другое — она была репликантом.

Начальство требует у Л замять и уничтожить все следы — и особенно важно найти и взять в MIT(О) таинственного ребенка, ведь если репликанты узнают, что их вид способен самовоспроизводиться естественным образом, они поднимут восстание, и миру придет конец.

Первым делом Л отправляется в штаб-квартиру (под номером  
`n`), всего таких штабов  
`n` в корпорации DP, где ему объясняют, что женщина, чьи данные он ищет, является старой моделью репликанта, и информация о ней была утеряна в результате «Блэкаута». После этого он встречается с помощницей К, которая показывает ему всю уцелевшую информацию о репликанте. Затем Л уходит, а начальство подозревает, что это дело может решить их проблему самовоспроизведения репликантов, и начинает следить за Л, который может помочь им с проблемой.

Главного героя по ходу расследования начали посещать флэшбеки о прошлой жизни. Хватаясь за ниточки прошлого, герой начал находить зацепки, которые привели его в пустынную Ленинградскую область, которая десятилетия назад была уничтожена, информация утеряна.

В занесенном песком Тихвине, заброшенном штабе под номером  
`1`, он находит Дейкстера. Сначала тот бросается на Л с водяным пистолетом и пытается зацезурено его, приняв за врага, но вскоре успокаивается и рассказывает, что видел искомого ребенка.

После этого появляются люди из DP во главе с К, они похищают Дейкстера, ранят Л и улетают. Они нашли героев благодаря полицейской системе слежения.

Благодаря маячку Дейкстера, Л находят члены тайного общества репликантов «Легион», которые были свидетелями рождения ребенка Дейкстера и репликанта Р.

Л расстраивается, но не меняет взглядов. Группа репликантов, в которой было  
`p` участников, готова ему помочь. Для этого необходимо пройти между штабами, совершив  
`m` переходов, чтобы добраться до DP и спасти информацию о ребенке. Переходя из  
`aᵢ` в `bᵢ`, из-за преград и охоты, Легион теряет  
`sᵢ` участников. Но находясь в штабе  
`i`, группа способна вербовать  
`wᵢ` за день участников, необходимое количество раз, чтобы совершить следующие переходы до главного штаба.

### Входные данные

Первая строка содержит три целых числа  
`n`, `m`, `p`  
(`2 ≤ n ≤ 1500`, `1 ≤ m ≤ 30000`, `0 ≤ p ≤ 10⁹`) — количество штабов, количество переходов, начальное количество людей в «Легионе».

Во второй строке даны `n` целых чисел  
`w₁`, `w₂`, ..., `wₙ`  
(`1 ≤ wᵢ ≤ 10⁹`) — количество новых участников.

В следующих `m` строках даны по три целых числа  
`aᵢ`, `bᵢ`, `sᵢ`  
(`1 ≤ aᵢ, bᵢ ≤ n`, `1 ≤ sᵢ ≤ 10⁹`) — начальный и конечный штаб, а также количество потерь `i`-го перемещения.

### Выходные данные

Главной проблемой Л является малое количество времени. Необходимо выяснить, за какое минимальное количество дней понадобится герою, чтобы попасть в главный штаб, а в случае невозможности такой операции необходимо вывести  
`−1`.

### Подзадачи

| № | Баллы | Необходимые подзадачи | Ограничения         |
|---|--------|-------------------------|----------------------|
| 1 | 50     | -                       | `s[i] < 100`         |
| 2 | 50     | 1                       | Нет доп. ограничений |

### Примеры

---

**STDIN**
```c++
4 4 2
7 4 3 1
1 2 21
3 2 6
1 3 8
2 4 11
```

**STDOUT**
```c++
4
```

---

**STDIN**
```c++
4 4 10
1 2 10 1
1 2 20
2 4 30
1 3 25 
3 4 89
```

**STDOUT**
```c++
24
```

---

**STDIN**
```c++
4 1 2
1 1 1 1 
1 3 2
```

**STDOUT**
```c++
-1
```

---

### Примечание

Днем считается только время, которое необходимо потратить, чтобы вербовать в «Легион» репликантов.

---

## H. Carpe diem

- Лимит времени: **4000 мс**
- Лимит памяти: **256 мб**

В тени вековых деревьев, окружающих колледж Уэлтон, скрытая от глаз мира, зарождается история о бунте души против устоев и традиций.

— О, мистер Китинг, вы открыли для нас мир, где слова имеют силу вызывать бури и разрушать стены, которые они сами себе воздвигли. Мы возродим общество мёртвых поэтов, тайное собрание, где каждый стих, каждая строфа — это акт мятежа, это дорога к себе настоящему.

Мы всего лишь читаем стихи из  
`n` четырёхсимвольных слов, в которой есть  
`m` рифм, что есть просто связь между словами, однако, когда эмоции переполняют, а слова становятся оружием против мира и самих себя, мы теряемся в лабиринте выборов и последствий. Рвите розы, пока не поздно. Поэма, написанная так давно, стала символом наших мечтаний и испытаний.

Как же нам научиться писать поэмы? Мы хотим, чтобы слова рифмовались не только друг с другом, но и с нашими судьбами. А как пойти по пути, что сделает нас уникальными? Мы не из тех, кто боится менять свою жизнь. Мы из тех, кто найдёт все уникальные наборы, что приведут нас от одного слова к другому одним единственным способом.

Мы читаем и сочиняем стихи не потому, что это красиво. Мы читаем и сочиняем стихи, потому что мы представители человечества, а человечеством движут чувства. Медицина, юриспруденция, бизнес, прикладные науки — всё это благородные занятия. И они необходимы, чтобы обеспечивать нам жизнь. Но поэзия, красота, романтика, любовь — это именно то, для чего мы живем.

### Входные данные

На первой строке два числа:  
`1 ≤ n ≤ 5·10⁵`,  
`1 ≤ m ≤ 10⁶`.  
На следующих `n` строках — четырёхсимвольные слова, состоящие из строчных латинских букв.  
После — на `m` строках — пары слов, что рифмуются между собой.

### Выходные данные

Вывести одно число — сумму длин последовательностей рифм, которые соединяют два слова единственным образом.

### Примеры

---

**STDIN**
```c++
6 6
road
molt
life
goat
boat
wife
road molt
road goat
road boat
life wife
molt goat
wife boat
```

**STDOUT**
```c++
10
```

---

**STDIN**
```c++
5 6
aaab
aaac
aaad
aaae
aaaf
aaac aaab
aaad aaac
aaad aaae
aaae aaac
aaae aaad
aaae aaaf

```

**STDOUT**
```c++
2
```

---

### Примечание

Слова рифмуются в обе стороны.

---

## I. Вернись живым

- Лимит времени: **1500 мс**
- Лимит памяти: **128 мб**

"Зачем они хотят, чтобы вы смотрели наверх? Они хотят, чтобы вы боялись! Они хотят, чтобы мы смотрели наверх, а они смотрели на нас сверху вниз. Они считают себя лучше вас!"

Обычных людей, в независимости от того, предпочитали они смотреть наверх или не смотреть, настигла неизбежная гибель. Спастись смогли только богатейшие и влиятельнейшие люди мира. Они улетели с земли на корабле с криогенными капсулами в поисках новой жизни на другой планете.

И вот их корабль приземлился на планету, которая казалась пригодной для жизни. Но на ней их ждали дикие и опасные животные, известные как бронтероги. Эти существа обитали между холмами и представляли собой серьёзную угрозу для людей.

Чтобы выжить, людям пришлось **разработать стратегию обхода этих холмов так, чтобы минимизировать время**, проведённое на открытой местности среди опасных созданий. Ночь предоставляла им некоторое преимущество, так как бронтероги были менее активны в темноте. Теперь им предстояло сделать все возможное, чтобы выжить на этой новой и непредсказуемой планете.

Вам дали карту этой планеты и сказали за ночь **обойти все холмы**, чтобы согласовать план действий вашей команды. Но будьте осторожны, **чем большее расстояние вы пройдёте рядом с бронтерогами, тем меньше шанс того, что вы вернётесь живым**.

### Входные данные

Вам заданы `N` холмов (`1≤N≤19`) расположенных на карте планеты, размеров `R×C` (`1≤R,C≤100`). Холм - максимальная связная группа символов `X` (группа клеток, имеющих хотя бы одну общую сторону).

В первой строке даны два числа `R` и `C`.  
В следующих `R` строках даны `C` символов: `.`, `X` или `S`.

`.` — там ходить нельзя.  
`S` — логова бронтерогов.  
`X` — холмы.

### Выходные данные

Выведите минимальное расстояние, которые необходимо пройти по логову бронтерогов (минимальное количество клеток их логова, которое необходимо пройти, чтобы побывать на всех холмах).  

Вы можете двигаться только вперёд, назад, вправо и влево. Вы можете начать свой путь с любого холма.

### Примеры

---

**STDIN**
```c++
5 4
XX.S
.S..
SXSS
S.SX
..SX
```

**STDOUT**
```c++
3
```

---

### Примечание

Гарантируется, что добраться до логова бронтерогов возможно.

---

## J. Конец или Начало

- Лимит времени: **1000 мс**
- Лимит памяти: **128 мб**

"Я не могу молчать! Всё вокруг кажется нереальным, но в то же время каким-то слишком настоящим. Кажется, я теряю себя. Я помню, как они пришли ко мне. Они спрашивали про сейф, какой-то сейф с деньгами или секретами, они говорили очень странно. Они хотят украсть у меня что-то, определённо. Говорили, что хотят помочь мне, но я им не верю. Ощущение того, что всё это сон, не покидает меня. Я хочу знать, так ли это, хочу понять, кому нужен этот сейф, секрет, тайна, да что бы там ни было, на самом деле. Сам я не смогу остановить 'их', мне нужна помощь. Я не знаю, к кому мне обратиться, никто же не поверит мне. А если это на самом деле сон, а они им каким-то образом управляют, они же не дадут мне узнать этого! Не позволят! Всё, что я могу сейчас сделать, это оставить свои записи. Может Вы, заинтересованный читатель, именно Вы, читая сейчас эти строки, поймёте, как помочь мне. Даже если со мной уже что-то случилось, может Вы обезопасите других. Вероятно, они могут навредить и другим. Мне нужно всё обдумать. Если это странное ощущение не пройдёт, я продолжу писать, лишь бы кто-то нашел мои записи, лишь бы это было не зря."

"Я не знаю, сколько времени прошло. Кажется, что я только-только отложил свой блокнот, но чернила от ручки выцвели так, словно кто-то оставил его раскрытым под палящим солнцем на месяц, не меньше! Такого же не происходит в жизни! Или я схожу с ума? Мне не стоит оставлять свои записи где попало, если их увидит кто-то 'лишний', они всё поймут. Они поймут, что я всё знаю."

"Всё становится более странным и пугающим. Я проснулся. Всё, что было раньше, действительно было сном! Но хорошие новости на этом заканчиваются. Я проснулся в новом сне. Ощущение всё то же, поменялось только окружение, моя одежда, но это не по-настоящему. Я не помню, как вышел из предыдущего сна, поэтому не понимаю, как провернуть этот трюк вновь. Кажется, стоит как-то структурировать свои записи, чтобы по ним Вы смогли помочь мне разобраться со всем."

"Хочу договориться с Вами, дорогой читатель, каждый новый сон я буду обозначать числом `A`. Если есть такой сон, в который я проснулся из сна `A`, давайте мы назовём его `B`, то сны `A` и `B` будут крепко связаны между собой. Но пусть это работает в обе стороны, пусть как `A` связано с `B`, так и `B` связано с `A`. Если в записях вдруг будет какая-то цепочка из сна `C` в сон `D`, то назовём такие сны просто связанными, не крепко. В случае моего примера со снами `A` и `B` они тоже просто связаны, крепкую связь будем считать частным случаем обычной связи. Что с этим делать, я пока не придумал. Напишу здесь позже."

"Ситуация не лучше. Ни капельки. Я начинаю путаться во снах. Кажется, что тот сон, из которого я проснулся в этот, был связан с каким-то другим. Точно не с этим. Кажется, я знаю, какая помощь мне нужна от Вас. Я хочу структурировать все эти связи, распутать эту непонятную паутину. Я хочу, чтобы Вы отвечали на запросы:

- `? A B` — тогда Вам нужно ответить, связаны ли сны `A` и `B`.
- `- A B` — тогда считайте, что крепко связанные сны `A` и `B` больше не связаны.

Надеюсь, Ваши исследования кому-то помогут. Даже если не мне."

### Входные данные

Первая строка входного файла содержит три целых числа, разделённые пробелами: `n` — количество снов, `m` — количество связей между ними и `q` — количество запросов Рассказчика (`0 ≤ n, m, q ≤ 200000`) ⟵.

Следующие `m` строк задают связи между снами:
`Aᵢ Bᵢ` — сны, связанные `i`-ой связью.

Далее следуют `q` строк, описывающих запросы Рассказчика. В начале строки находится символ `tᵢ` (`?` или `-`) — тип запроса, за которым следуют два числа `A B` (`1 ≤ A, B ≤ n`).

- Если `tᵢ = ?`, то необходимо вывести `YES`, если сны `A` и `B` связаны, иначе — `NO`.
- Если `tᵢ = -`, то следует считать, что крепко связанные сны `A` и `B` больше не связаны.

### Выходные данные

Для каждой операции `? A B` во входном файле выведите на отдельной строке `YES`, если сны `A` и `B` связаны, иначе выведите `NO`.


### Примеры

---

**STDIN**
```c++
3 3 8
1 2
2 3
1 3
? 1 1
? 1 3 
- 1 2
? 1 3
- 2 3
? 2 3
- 1 3
? 1 1
```

**STDOUT**
```c++
YES
YES
YES
NO
YES
```

### [Решение](J.cpp)

---